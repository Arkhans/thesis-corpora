A gendarme who exchanged himself for a hostage during the French supermarket siege has died, bringing the number of victims to four. Police shot dead the attacker after a series of attacks claimed by Islamic State in Carcassonne, southern France, that culminated in the three-hour hostage-taking.

The attacker, named as Radouane Lakdim, 25, was born in Morocco and lived in Carcassonne. He was known to police for petty crimes and drug-dealing. The state prosecutor François Molins said he had been under surveillance in 2016 and 2017 for his "radicalism and proximity to Salafist movements" but had showed no signs he was going to carry out an attack. Questions will be asked as to how Lakdim was able to obtain a weapon and carry out attacks when he had been monitored by security services.

The interior minister, Gérard Collomb, said, "We had monitored him and did not think he had been radicalized." He added, "He was already under surveillance when he suddenly decided to act."

Just after 10 am on Friday, Lakdim stopped a white Opel Corsa car on the outskirts of Carcassonne, before shooting and killing the passenger and seriously injuring the driver. The prosecutor said Lakdim then drove off in the car and appeared to wait outside a military barracks for soldiers. He then drove to a riot police squad barracks and shot at four officers 200 meters away who had been out jogging. He seriously wounded one of the group, who suffered broken ribs and a punctured lung. A bullet struck near one officer's heart.

Lakdim then drove to a Super U supermarket 8 km away in Trèbes, a sleepy town of 5,000 people near Carcassonne. At about 11 am, he walked into the shop shouting Allahu Akbar and claiming he was a soldier from Islamic State. Around 50 people were inside the building. Lakdim opened fire, killing one supermarket worker and one customer.

Gendarmes attempting to evacuate the supermarket found Lakdim holding several hostages. A gendarme volunteered to take the hostages' place. The gunman agreed to the swap, so the gendarme stayed with him while others were evacuated. That gendarme left his mobile phone line open on a table so security forces outside could hear what was going on inside. When security forces outside the store heard via the telephone that a shot was fired, they immediately stormed the supermarket and shot Lakdim dead.

Lt Col Arnaud Beltrame, the gendarme who had swapped places with the hostages, was found seriously injured. Early on Saturday morning, the French interior ministry said Beltrame had died from his injuries. Collomb praised the officer's heroism. Two other officers were injured by gunshots during the assault.

The situation at the supermarket lasted just over three hours, during which the gunman had asked for the release of Salah Abdeslam, the only surviving suspect from the group that carried out the November 2015 Paris attacks, French state TV reported. Abdeslam is in solitary confinement in a French prison as the investigation into the Paris attacks continues.

The interior ministry said Lakdim was acting alone in Friday's attack. The state prosecutor said he had been on an intelligence watchlist since 2014. Lakdim had been convicted twice in 2011 and 2015 for petty crime, including drug offenses. He had served one month in prison in 2016. The prosecutor said that during surveillance, security services had not seen signs that suggested Lakdim would commit an attack.